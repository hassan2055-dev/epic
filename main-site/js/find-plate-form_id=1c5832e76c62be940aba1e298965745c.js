/*! For license information please see find-plate-form.js.LICENSE.txt */
(()=>{"use strict";var t=function(){return new Promise(function(t){"scheduler"in window&&"yield"in window.scheduler?window.scheduler.yield().then(t):setTimeout(t,0)})};function e(){var t,i,o="function"==typeof Symbol?Symbol:{},r=o.iterator||"@@iterator",a=o.toStringTag||"@@toStringTag";function c(e,o,r,a){var c=o&&o.prototype instanceof l?o:l,d=Object.create(c.prototype);return n(d,"_invoke",function(e,n,o){var r,a,c,l=0,d=o||[],s=!1,f={p:0,n:0,v:t,a:v,f:v.bind(t,4),d:function(e,n){return r=e,a=0,c=t,f.n=n,u}};function v(e,n){for(a=e,c=n,i=0;!s&&l&&!o&&i<d.length;i++){var o,r=d[i],v=f.p,p=r[2];e>3?(o=p===n)&&(c=r[(a=r[4])?5:(a=3,3)],r[4]=r[5]=t):r[0]<=v&&((o=e<2&&v<r[1])?(a=0,f.v=n,f.n=r[1]):v<p&&(o=e<3||r[0]>n||n>p)&&(r[4]=e,r[5]=n,f.n=p,a=0))}if(o||e>1)return u;throw s=!0,n}return function(o,d,p){if(l>1)throw TypeError("Generator is already running");for(s&&1===d&&v(d,p),a=d,c=p;(i=a<2?t:c)||!s;){r||(a?a<3?(a>1&&(f.n=-1),v(a,c)):f.n=c:f.v=c);try{if(l=2,r){if(a||(o="next"),i=r[o]){if(!(i=i.call(r,c)))throw TypeError("iterator result is not an object");if(!i.done)return i;c=i.value,a<2&&(a=0)}else 1===a&&(i=r.return)&&i.call(r),a<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),a=1);r=t}else if((i=(s=f.n<0)?c:e.call(n,f))!==u)break}catch(e){r=t,a=1,c=e}finally{l=1}}return{value:i,done:s}}}(e,r,a),!0),d}var u={};function l(){}function d(){}function s(){}i=Object.getPrototypeOf;var f=[][r]?i(i([][r]())):(n(i={},r,function(){return this}),i),v=s.prototype=l.prototype=Object.create(f);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,s):(t.__proto__=s,n(t,a,"GeneratorFunction")),t.prototype=Object.create(v),t}return d.prototype=s,n(v,"constructor",s),n(s,"constructor",d),d.displayName="GeneratorFunction",n(s,a,"GeneratorFunction"),n(v),n(v,a,"Generator"),n(v,r,function(){return this}),n(v,"toString",function(){return"[object Generator]"}),(e=function(){return{w:c,m:p}})()}function n(t,e,i,o){var r=Object.defineProperty;try{r({},"",{})}catch(t){r=0}n=function(t,e,i,o){function a(e,i){n(t,e,function(t){return this._invoke(e,i,t)})}e?r?r(t,e,{value:i,enumerable:!o,configurable:!o,writable:!o}):t[e]=i:(a("next",0),a("throw",1),a("return",2))},n(t,e,i,o)}function i(t,e,n,i,o,r,a){try{var c=t[r](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(i,o)}function o(t){return function(){var e=this,n=arguments;return new Promise(function(o,r){var a=t.apply(e,n);function c(t){i(a,o,r,c,u,"next",t)}function u(t){i(a,o,r,c,u,"throw",t)}c(void 0)})}}window.addEventListener("pageshow",function(t){document.querySelectorAll(".find-vin__plate-btn").forEach(function(t){t.classList.remove("loader-v2"),t.disabled=!1})}),document.addEventListener("DOMContentLoaded",function(){var n,i=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2e3;return new Promise(function(n){try{dataLayer.push({event:t,eventTimeout:e,eventCallback:n})}catch(t){n()}})},r=(n=!1,window.addEventListener("pageshow",function(t){return n=!1}),function(t){n||(n=!0,window.location.assign(t))});function a(t,e,n,o){document.dispatchEvent(new CustomEvent("amplitude:checkVin",{detail:{type:"plate"}})),e.type="plate",$.ajax({type:"POST",url:t,data:e,dataType:"html",success:function(t){var e=JSON.parse(t);if(e.html)document.dispatchEvent(new CustomEvent("precheck:loaded",{detail:{html:e.html,vin:e.vin}}));else if(e.vin){if(window.isDealerSub)return function(t){try{var e,n;null===(e=dataLayer)||void 0===e||null===(n=e.push)||void 0===n||n.call(e,{event:t})}catch(t){}}("checkPlate"),void $('<form action="'+window.getReportUrl+'" method="post"/>').append($('<input type="hidden" name="vin">').val(e.vin)).appendTo($("body")).submit();var a=(window.checkOutRoute||"").replace(/\/+$/,"")+"/"+e.vin;Promise.race([i("checkPlate",2e3),(l=2500,new Promise(function(t){return setTimeout(t,l)}))]).then(function(){return r(a)})}else{var l;u(n,o,e.message),c(o)}},error:function(t){c(o),console.log(t)}})}function c(t){var e=t.querySelector(".find-vin__plate-btn");e.classList.remove("loader-v2"),e.disabled=!1}function u(t,e,n){n&&t.attr("data-original-title",n),t.tooltip("show"),$(".tooltip").addClass("tooltip-plate-license"),e.querySelector(".find-vin__group").classList.add("find-vin__group--invalid");var i=performance.now()+2e3,o=function(){performance.now()>=i?(t.tooltip("hide"),e.querySelector(".find-vin__group").classList.remove("find-vin__group--invalid")):requestAnimationFrame(o)};requestAnimationFrame(o)}window.plateFormReady=!0,document.querySelectorAll(".find-vin__form--plate").forEach(function(n){n.addEventListener("submit",function(n){var i;if(n.preventDefault(),null!==(i=window.onDh)&&void 0!==i&&i)$("#dispute-modal").modal({show:!0});else{var r=n.currentTarget.elements.plate.value.trim(),l=n.currentTarget.elements.state.value,d=$(this).find(".find-vin__tooltip--plate"),s=$(this).find(".find-vin__tooltip--state"),f=$(this).find(".find-vin__tooltip--error"),v=this;if(function(t){var e=t.querySelector(".find-vin__plate-btn");e.classList.add("loader-v2"),e.disabled=!0}(this),!r.length)return u(d,v),void c(this);if(!l.length)return u(s,v),void c(this);new Promise(function(t){var e=function(){"undefined"!=typeof grecaptcha&&grecaptcha.execute?t():setTimeout(e,500)};e()}).then(o(e().m(function n(){return e().w(function(n){for(;;)switch(n.n){case 0:return n.n=1,t();case 1:grecaptcha.ready(o(e().m(function n(){var i;return e().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,grecaptcha.execute(window.recaptchaSiteKeyCode,{action:"plate"});case 1:return i=e.v,e.n=2,t();case 2:a(void 0!==window.precheckAjaxRoute?window.precheckAjaxRoute:window.plateAjax,{plate:r,state:l,recaptcha_response:i},f,v);case 3:return e.a(2)}},n)})));case 2:return n.a(2)}},n)})))}})}),document.addEventListener("input",function(t){t.target.classList.contains("find-vin__input")&&(document.querySelectorAll(".find-vin__group--plate").forEach(function(t){t.classList.remove("find-vin__group--invalid")}),$('.find-vin__tooltip[data-toggle="tooltip"]').tooltip("hide"))}),document.addEventListener("change",function(t){t.target.classList.contains("find-vin__select")&&(document.querySelectorAll(".find-vin__group--plate").forEach(function(t){t.classList.remove("find-vin__group--invalid")}),$('.find-vin__tooltip[data-toggle="tooltip"]').tooltip("hide"),""!==t.target.value?t.target.classList.add("find-vin__select--active"):t.target.classList.remove("find-vin__select--active"))})})})();